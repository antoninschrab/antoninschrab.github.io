@article{schrab2021mmd,
  title = {{MMD} Aggregated Two-Sample Test},
  author = {Antonin Schrab and Ilmun Kim and M{\'e}lisande Albert and B{\'e}atrice Laurent and Benjamin Guedj and Arthur Gretton},
  journal = {Journal of Machine Learning Research},
  year = {2023},
  volume = {24},
  number = {194},
  pages = {1--81},
  abstract = {We propose two novel nonparametric two-sample kernel tests based on the Maximum Mean Discrepancy (MMD). First, for a fixed kernel, we construct an MMD test using either permutations or a wild bootstrap, two popular numerical procedures to determine the test threshold. We prove that this test controls the probability of type I error non-asymptotically. Hence, it can be used reliably even in settings with small sample sizes as it remains well-calibrated, which differs from previous MMD tests which only guarantee correct test level asymptotically. When the difference in densities lies in a Sobolev ball, we prove minimax optimality of our MMD test with a specific kernel depending on the smoothness parameter of the Sobolev ball. In practice, this parameter is unknown and, hence, the optimal MMD test with this particular kernel cannot be used. To overcome this issue, we construct an aggregated test, called MMDAgg, which is adaptive to the smoothness parameter. The test power is maximised over the collection of kernels used, without requiring held-out data for kernel selection (which results in a loss of test power), or arbitrary kernel choices such as the median heuristic. We prove that MMDAgg still controls the level non-asymptotically, and achieves the minimax rate over Sobolev balls, up to an iterated logarithmic term. Our guarantees are not restricted to a specific type of kernel, but hold for any product of one-dimensional translation invariant characteristic kernels. We provide a user-friendly parameter-free implementation of MMDAgg using an adaptive collection of bandwidths. We demonstrate that MMDAgg significantly outperforms alternative state-of-the-art MMD-based two-sample tests on synthetic data satisfying the Sobolev smoothness assumption, and that, on real-world image data, MMDAgg closely matches the power of tests leveraging the use of models such as neural networks.},
  keywords = {Two-sample testing},
  url = {http://jmlr.org/papers/v24/21-1289.html},
  url_PDF = {https://jmlr.org/papers/volume24/21-1289/21-1289.pdf},
  url_Code_1 = {https://github.com/antoninschrab/mmdagg},
  url_Code_2 = {https://github.com/antoninschrab/mmdagg-paper},
  url_Slides_1 = {https://antoninschrab.github.io/files/Slides_MMDAgg_KSDAgg_long.pdf},
  url_Slides_2 = {https://antoninschrab.github.io/files/Slides_handout-31-05-22.pdf},
  url_Poster_1 = {https://antoninschrab.github.io/files/Poster_MMDAgg_KSDAgg.pdf},
  url_Poster_2 = {https://antoninschrab.github.io/files/Poster_MMDAgg.pdf},
  url_Video_1 = {https://youtu.be/F0VOCrAf5_M},
  url_Video_2 = {https://youtu.be/OWh6Hj10wsY},
  eprint = {2110.15073},
  archivePrefix = {arXiv},
  primaryClass = {stat.ML}
}

@inproceedings{schrab2022ksd,
  title = {{KSD} Aggregated Goodness-of-fit Test},
  author = {Antonin Schrab and Benjamin Guedj and Arthur Gretton},
  booktitle = {Advances in Neural Information Processing Systems 35: Annual Conference on Neural Information Processing Systems 2022, NeurIPS 2022},
  editor = {Alice H. Oh and Alekh Agarwal and Danielle Belgrave and Kyunghyun Cho},
  year = {2022},
  abstract = {We investigate properties of goodness-of-fit tests based on the Kernel Stein Discrepancy (KSD). We introduce a strategy to construct a test, called KSDAgg, which aggregates multiple tests with different kernels. KSDAgg avoids splitting the data to perform kernel selection (which leads to a loss in test power), and rather maximises the test power over a collection of kernels. We provide theoretical guarantees on the power of KSDAgg: we show it achieves the smallest uniform separation rate of the collection, up to a logarithmic term. KSDAgg can be computed exactly in practice as it relies either on a parametric bootstrap or on a wild bootstrap to estimate the quantiles and the level corrections. In particular, for the crucial choice of bandwidth of a fixed kernel, it avoids resorting to arbitrary heuristics (such as median or standard deviation) or to data splitting. We find on both synthetic and real-world data that KSDAgg outperforms other state-of-the-art adaptive KSD-based goodness-of-fit testing procedures.},
  keywords = {Goodness-of-fit testing},
  url = {https://proceedings.neurips.cc/paper_files/paper/2022/hash/d241a7b1499cee1bf40769ceade2444d-Abstract-Conference.html},
  url_PDF = {https://proceedings.neurips.cc/paper_files/paper/2022/file/d241a7b1499cee1bf40769ceade2444d-Paper-Conference.pdf},
  url_Supplemental = {https://proceedings.neurips.cc/paper_files/paper/2022/file/d241a7b1499cee1bf40769ceade2444d-Supplemental-Conference.pdf},
  url_Code_1 = {https://github.com/antoninschrab/ksdagg},
  url_Code_2 = {https://github.com/antoninschrab/ksdagg-paper},
  url_Slides_1 = {https://antoninschrab.github.io/files/Slides_MMDAgg_KSDAgg_long.pdf},
  url_Slides_2 = {https://antoninschrab.github.io/files/Slides_handout-31-05-22.pdf},
  url_Slides_3 = {https://nips.cc/media/neurips-2022/Slides/54932.pdf},
  url_Poster_1 = {https://nips.cc/media/PosterPDFs/NeurIPS%202022/54932.png?t=1669384001.1315906},
  url_Poster_2 = {https://antoninschrab.github.io/files/Poster_MMDAgg_KSDAgg.pdf},
  url_Poster_3 = {https://antoninschrab.github.io/files/Poster-03-09-22.pdf},
  url_Video_1 = {https://nips.cc/virtual/2022/poster/54932},
  url_Video_2 = {https://youtu.be/F0VOCrAf5_M},
  url_Video_3 = {https://youtu.be/OWh6Hj10wsY},
  eprint = {2202.00824},
  archivePrefix = {arXiv},
  primaryClass = {stat.ML}
}

@inproceedings{schrab2022efficient,
  title = {Efficient Aggregated Kernel Tests using Incomplete {$U$}-statistics},
  author = {Antonin Schrab and Ilmun Kim and Benjamin Guedj and Arthur Gretton},
  booktitle = {Advances in Neural Information Processing Systems 35: Annual Conference on Neural Information Processing Systems 2022, NeurIPS 2022},
  editor = {Alice H. Oh and Alekh Agarwal and Danielle Belgrave and Kyunghyun Cho},
  year = {2022},
  abstract = {We propose a series of computationally efficient, nonparametric tests for the two-sample, independence and goodness-of-fit problems, using the Maximum Mean Discrepancy (MMD), Hilbert Schmidt Independence Criterion (HSIC), and Kernel Stein Discrepancy (KSD), respectively. Our test statistics are incomplete $U$-statistics, with a computational cost that interpolates between linear time in the number of samples, and quadratic time, as associated with classical $U$-statistic tests. The three proposed tests aggregate over several kernel bandwidths to detect departures from the null on various scales: we call the resulting tests MMDAggInc, HSICAggInc and KSDAggInc. For the test thresholds, we derive a quantile bound for wild bootstrapped incomplete $U$- statistics, which is of independent interest. We derive uniform separation rates for MMDAggInc and HSICAggInc, and quantify exactly the trade-off between computational efficiency and the attainable rates: this result is novel for tests based on incomplete $U$-statistics, to our knowledge. We further show that in the quadratic-time case, the wild bootstrap incurs no penalty to test power over more widespread permutation-based approaches, since both attain the same minimax optimal rates (which in turn match the rates that use oracle quantiles). We support our claims with numerical experiments on the trade-off between computational efficiency and test power. In the three testing frameworks, we observe that our proposed linear-time aggregated tests obtain higher power than current state-of-the-art linear-time kernel tests.},
  keywords = {Two-sample testing, Independence testing, Goodness-of-fit testing},
  url = {https://proceedings.neurips.cc/paper_files/paper/2022/hash/774164b966cc277c82a960934445140d-Abstract-Conference.html},
  url_PDF = {https://proceedings.neurips.cc/paper_files/paper/2022/file/774164b966cc277c82a960934445140d-Paper-Conference.pdf},
  url_Supplemental = {https://proceedings.neurips.cc/paper_files/paper/2022/file/774164b966cc277c82a960934445140d-Supplemental-Conference.pdf},
  url_Code_1 = {https://github.com/antoninschrab/agginc},
  url_Code_2 = {https://github.com/antoninschrab/agginc-paper},
  url_Slides_1 = {https://antoninschrab.github.io/files/Slides_handout-31-05-22.pdf},
  url_Slides_2 = {https://nips.cc/media/neurips-2022/Slides/54933.pdf},
  url_Poster_1 = {https://nips.cc/media/PosterPDFs/NeurIPS%202022/54933.png?t=1669384934.1906412},
  url_Poster_2 = {https://antoninschrab.github.io/files/Poster-03-09-22.pdf},
  url_Video = {https://nips.cc/virtual/2022/poster/54933},
  eprint = {2206.09194},
  archivePrefix = {arXiv},
  primaryClass = {stat.ML}
}

@article{schrab2022discussion,
  author = {Antonin Schrab and Wittawat Jitkrittum and Zolt\'an Szab\'o and Dino Sejdinovic and Arthur Gretton},
  title = {Discussion of `{M}ultiscale {F}isher's Independence Test for Multivariate Dependence'},
  journal = {Biometrika},
  volume = {109},
  number = {3},
  pages = {597-603},
  year = {2022},
  month = {08},
  issn = {1464-3510},
  doi = {10.1093/biomet/asac028},
  url = {https://doi.org/10.1093/biomet/asac028},
  eprint = {https://academic.oup.com/biomet/article-pdf/109/3/597/45512180/asac028.pdf},
  url_arXiv = {https://arxiv.org/pdf/2206.11142},
  abstract = {We discuss how MultiFIT, the Multiscale Fisher's Independence Test for Multivariate Dependence proposed by Gorsky and Ma (2022), compares to existing linear-time kernel tests based on the Hilbert-Schmidt independence criterion (HSIC). We highlight the fact that the levels of the kernel tests at any finite sample size can be controlled exactly, as it is the case with the level of MultiFIT. In our experiments, we observe some of the performance limitations of MultiFIT in terms of test power.},
  keywords = {Independence testing},
  eprint = {2206.11142},
  archivePrefix = {arXiv},
  primaryClass = {stat.ME}
}

@article{biggs2023mmdfuse,
  author        = {Biggs, Felix and Schrab, Antonin and Gretton, Arthur},
  title         = {{MMD-FUSE}: {L}earning and Combining Kernels for Two-Sample Testing Without Data Splitting},
  year          = {2023},
  journal       = {Advances in Neural Information Processing Systems},
  volume        = {36},
  note = "Spotlight at NeurIPS 2023.",
  abstract = {We propose novel statistics which maximise the power of a two-sample test based on the Maximum Mean Discrepancy (MMD), by adapting over the set of kernels used in defining it. For finite sets, this reduces to combining (normalised) MMD values under each of these kernels via a weighted soft maximum. Exponential concentration bounds are proved for our proposed statistics under the null and alternative. We further show how these kernels can be chosen in a data-dependent but permutation-independent way, in a well-calibrated test, avoiding data splitting. This technique applies more broadly to general permutation-based MMD testing, and includes the use of deep kernels with features learnt using unsupervised models such as auto-encoders. We highlight the applicability of our MMD-FUSE test on both synthetic low-dimensional and real-world high-dimensional data, and compare its performance in terms of power against current state-of-the-art kernel tests.},
  keywords = {Two-sample testing},
  url = {https://arxiv.org/abs/2306.08777},
  url_PDF = {https://arxiv.org/pdf/2306.08777.pdf},
  url_Code_1 = {https://github.com/antoninschrab/mmdfuse},
  url_Code_2 = {https://github.com/antoninschrab/mmdfuse-paper},
  url_Slides = {https://antoninschrab.github.io/files/Slides_MMDFUSE.pdf},
  eprint = {2306.08777},
  archivePrefix = {arXiv},
  primaryClass = {stat.ML}
}

@unpublished{kim2023differentially,
title = {Differentially Private Permutation Tests: {A}pplications to Kernel Methods}, 
author = {Ilmun Kim and Antonin Schrab},
year = {2023},
note = "Arxiv preprint 2310.19043.",
abstract = {Recent years have witnessed growing concerns about the privacy of sensitive data. In response to these concerns, differential privacy has emerged as a rigorous framework for privacy protection, gaining widespread recognition in both academic and industrial circles. While substantial progress has been made in private data analysis, existing methods often suffer from impracticality or a significant loss of statistical efficiency. This paper aims to alleviate these concerns in the context of hypothesis testing by introducing differentially private permutation tests. The proposed framework extends classical non-private permutation tests to private settings, maintaining both finite-sample validity and differential privacy in a rigorous manner. The power of the proposed test depends on the choice of a test statistic, and we establish general conditions for consistency and non-asymptotic uniform power. To demonstrate the utility and practicality of our framework, we focus on reproducing kernel-based test statistics and introduce differentially private kernel tests for two-sample and independence testing: dpMMD and dpHSIC. The proposed kernel tests are straightforward to implement, applicable to various types of data, and attain minimax optimal power across different privacy regimes. Our empirical evaluations further highlight their competitive power under various synthetic and real-world scenarios, emphasizing their practical value. The code is publicly available to facilitate the implementation of our framework.},
keywords = {Differential privacy, Two-sample testing, Independence testing},
url = {https://arxiv.org/abs/2310.19043},
url_Code_1 = {https://github.com/antoninschrab/dpkernel},
url_Code_2 = {https://github.com/antoninschrab/dpkernel-paper},
eprint={2310.19043},
archivePrefix={arXiv},
primaryClass={math.ST}
}

@unpublished{pogodin2024practical,
  title={Practical Kernel Tests of Conditional Independence},
  author={Pogodin, Roman and Schrab, Antonin and Li, Yazhe and Sutherland, Danica J and Gretton, Arthur},
  keywords = {Conditional independence testing},
  year={2024},
  note = "Arxiv preprint 2402.13196.",
  abstract = {We describe a data-efficient, kernel-based approach to statistical testing of conditional independence. A major challenge of conditional independence testing, absent in tests of unconditional independence, is to obtain the correct test level (the specified upper bound on the rate of false positives), while still attaining competitive test power. Excess false positives arise due to bias in the test statistic, which is obtained using nonparametric kernel ridge regression. We propose three methods for bias control to correct the test level, based on data splitting, auxiliary data, and (where possible) simpler function classes. We show these combined strategies are effective both for synthetic and real-world data.},
  url = {https://arxiv.org/abs/2402.13196},
  url_Code_1 = {https://github.com/romanpogodin/kernel-ci-testing},
  eprint = {2402.13196},
  archivePrefix = {arXiv},
  primaryClass = {stat.ML}
}

@unpublished{schrab2024robust,
  title = {Robust Kernel Hypothesis Testing under Data Corruption},
  author = {Antonin Schrab and Ilmun Kim},
  keywords = {Robustness, Differential privacy, Two-sample testing, Independence testing},
  year = {2024},
  note = "Arxiv preprint 2405.19912.",
  abstract = {We propose two general methods for constructing robust permutation tests under data corruption. The proposed tests effectively control the non-asymptotic type I error under data corruption, and we prove their consistency in power under minimal conditions. This contributes to the practical deployment of hypothesis tests for real-world applications with potential adversarial attacks. One of our methods inherently ensures differential privacy, further broadening its applicability to private data analysis. For the two-sample and independence settings, we show that our kernel robust tests are minimax optimal, in the sense that they are guaranteed to be non-asymptotically powerful against alternatives uniformly separated from the null in the kernel MMD and HSIC metrics at some optimal rate (tight with matching lower bound). Finally, we provide publicly available implementations and empirically illustrate the practicality of our proposed tests.},
  url = {https://arxiv.org/abs/2405.19912},
  url_Code_1 = {https://github.com/antoninschrab/dckernel},
  url_Code_2 = {https://github.com/antoninschrab/dckernel-paper},
  eprint = {2405.19912},
  archivePrefix = {arXiv},
  primaryClass = {stat.ML}
}
